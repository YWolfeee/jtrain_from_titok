Thu Jan 16 01:51:24 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.28.03              Driver Version: 560.28.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A40                     Off |   00000000:3C:00.0 Off |                    0 |
|  0%   31C    P8             22W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
attention mode is flash
[01/16 01:51:43 TiTok]: Saving config to dry_run_stage1_run1/config.yaml
[01/16 01:51:43 TiTok]: Config:
experiment:
  project: dry_run_stage1
  name: dry_run_stage1_run1
  output_dir: dry_run_stage1_run1
  max_train_examples: 1281167
  save_every: 1
  eval_every: 1
  generate_every: 1
  log_every: 1
  log_grad_norm_every: 1
  resume: true
  init_weight: ''
  logging_dir: dry_run_stage1_run1/logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: large
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 512
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
  reconstruction_regularization:
    name: matryoshka
    mask_ratio_method: uniform
    max_mask_rate: 0.95
    use_annealing: true
    annealing:
      time_start: 0.25
      time_end: 0.75
      is_increasing: false
  use_reconstruction_regularization: true
losses:
  quantizer_weight: 1.0
dataset:
  params:
    train_shards_path_or_url: /mnt/rdata8/imagenet_wds/imagenet-train-{000000..000252}.tar
    eval_shards_path_or_url: /mnt/rdata8/imagenet_wds/imagenet-val-{000000..000009}.tar
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0004
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 128
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 250000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/dry_run.yaml

[01/16 01:51:44 TiTok]: Creating model and loss module.
========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
TiTok                                              [1, 3, 256, 256]          [1, 1024, 16, 16]         524,288                     0.09%                   --                        --
├─TiTokEncoder: 1-1                                --                        [1, 12, 1, 512]           788,480                     0.13%                   --                        --
│    └─Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 1024, 16, 16]         787,456                     0.13%                   [16, 16]                  201,588,736
│    └─LayerNorm: 2-2                              [1, 769, 1024]            [1, 769, 1024]            2,048                       0.00%                   --                        2,048
│    └─ModuleList: 2-3                             --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-2           [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-3                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-4                   [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-1                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-2                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-2            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-6           [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-7                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-8                   [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-4                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-5                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-3            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-10          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-11                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-12                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-7                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-8                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-4            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-14          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-15                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-16                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-10                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-11                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-5            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-18          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-19                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-20                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-13                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-14                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-6            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-22          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-23                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-24                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-16                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-17                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-7            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-26          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-27                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-28                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-19                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-20                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-8            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-30          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-31                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-32                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-22                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-23                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-9            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-34          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-35                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-36                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-25                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-26                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-10           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-38          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-39                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-40                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-28                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-29                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-11           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-42          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-43                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-44                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-31                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-32                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-12           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-46          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-47                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-48                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-34                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-35                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-13           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-50          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-51                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-52                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-37                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-38                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-14           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-54          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-55                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-56                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-40                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-41                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-15           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-58          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-59                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-60                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-43                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-44                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-16           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-62          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-63                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-64                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-46                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-47                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-17           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-66          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-67                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-68                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-49                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-50                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-18           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-70          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-71                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-72                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-52                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-53                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-19           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-74          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-75                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-76                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-55                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-56                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-20           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-78          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-79                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-80                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-58                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-59                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-21           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-82          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-83                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-84                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-61                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-62                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-22           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-86          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-87                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-88                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-64                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-65                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-23           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-90          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-91                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-92                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-67                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-68                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-24           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-94          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-95                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-96                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-70                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-71                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    └─LayerNorm: 2-4                              [1, 512, 1024]            [1, 512, 1024]            2,048                       0.00%                   --                        2,048
│    └─Conv2d: 2-5                                 [1, 1024, 512, 1]         [1, 12, 512, 1]           12,300                      0.00%                   [1, 1]                    6,297,600
├─VectorQuantizer: 1-2                             [1, 12, 1, 512]           [1, 12, 1, 512]           --                             --                   --                        --
│    └─Embedding: 2-6                              [512]                     [512, 12]                 49,152                      0.01%                   --                        25,165,824
├─TiTokDecoder: 1-3                                [1, 12, 1, 512]           [1, 1024, 16, 16]         789,504                     0.13%                   --                        --
│    └─Linear: 2-7                                 [1, 512, 12]              [1, 512, 1024]            13,312                      0.00%                   --                        13,312
│    └─LayerNorm: 2-8                              [1, 769, 1024]            [1, 769, 1024]            2,048                       0.00%                   --                        2,048
│    └─ModuleList: 2-9                             --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-25           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-97                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-98          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-99                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-100                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-73                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-74                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-75                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-26           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-101                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-102         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-103                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-104                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-76                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-77                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-78                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-27           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-105                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-106         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-107                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-108                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-79                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-80                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-81                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-28           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-109                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-110         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-111                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-112                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-82                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-83                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-84                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-29           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-113                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-114         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-115                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-116                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-85                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-86                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-87                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-30           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-117                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-118         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-119                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-120                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-88                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-89                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-90                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-31           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-121                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-122         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-123                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-124                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-91                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-92                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-93                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-32           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-125                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-126         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-127                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-128                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-94                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-95                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-96                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-33           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-129                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-130         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-131                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-132                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-97                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-98                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-99                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-34           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-133                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-134         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-135                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-136                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-100                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-101                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-102                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-35           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-137                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-138         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-139                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-140                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-103                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-104                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-105                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-36           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-141                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-142         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-143                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-144                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-106                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-107                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-108                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-37           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-145                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-146         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-147                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-148                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-109                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-110                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-111                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-38           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-149                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-150         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-151                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-152                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-112                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-113                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-114                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-39           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-153                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-154         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-155                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-156                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-115                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-116                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-117                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-40           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-157                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-158         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-159                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-160                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-118                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-119                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-120                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-41           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-161                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-162         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-163                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-164                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-121                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-122                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-123                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-42           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-165                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-166         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-167                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-168                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-124                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-125                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-126                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-43           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-169                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-170         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-171                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-172                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-127                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-128                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-129                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-44           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-173                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-174         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-175                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-176                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-130                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-131                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-132                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-45           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-177                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-178         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-179                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-180                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-133                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-134                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-135                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-46           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-181                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-182         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-183                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-184                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-136                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-137                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-138                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-47           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-185                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-186         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-187                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-188                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-139                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-140                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-141                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-48           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-189                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-190         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-191                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-192                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-142                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-143                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-144                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    └─LayerNorm: 2-10                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
│    └─Sequential: 2-11                            [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-49                           [1, 1024, 16, 16]         [1, 2048, 16, 16]         2,099,200                   0.34%                   [1, 1]                    537,395,200
│    │    └─Tanh: 3-50                             [1, 2048, 16, 16]         [1, 2048, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-51                           [1, 2048, 16, 16]         [1, 1024, 16, 16]         2,098,176                   0.34%                   [1, 1]                    537,133,056
│    └─Identity: 2-12                              [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
========================================================================================================================================================================================================
Total params: 611,788,812
Trainable params: 611,788,812
Non-trainable params: 0
Total mult-adds (G): 311.29
========================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 2148.25
Params size (MB): 1632.65
Estimated Total Size (MB): 3781.69
========================================================================================================================================================================================================
[01/16 01:51:52 TiTok]: ========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
TiTok                                              [1, 3, 256, 256]          [1, 1024, 16, 16]         524,288                     0.09%                   --                        --
├─TiTokEncoder: 1-1                                --                        [1, 12, 1, 512]           788,480                     0.13%                   --                        --
│    └─Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 1024, 16, 16]         787,456                     0.13%                   [16, 16]                  201,588,736
│    └─LayerNorm: 2-2                              [1, 769, 1024]            [1, 769, 1024]            2,048                       0.00%                   --                        2,048
│    └─ModuleList: 2-3                             --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-2           [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-3                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-4                   [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-1                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-2                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-2            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-6           [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-7                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-8                   [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-4                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-5                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-3            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9                    [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-10          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-11                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-12                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-7                  [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-8                    [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9                  [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-4            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-14          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-15                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-16                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-10                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-11                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-5            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-18          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-19                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-20                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-13                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-14                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-6            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-22          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-23                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-24                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-16                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-17                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-7            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-26          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-27                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-28                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-19                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-20                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-8            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-30          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-31                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-32                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-22                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-23                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-9            [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-34          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-35                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-36                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-25                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-26                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-10           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-38          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-39                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-40                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-28                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-29                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-11           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-42          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-43                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-44                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-31                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-32                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-12           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-46          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-47                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-48                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-34                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-35                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-13           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-50          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-51                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-52                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-37                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-38                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-14           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-54          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-55                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-56                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-40                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-41                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-15           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-58          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-59                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-60                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-43                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-44                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-16           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-62          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-63                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-64                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-46                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-47                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-17           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-66          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-67                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-68                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-49                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-50                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-18           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-70          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-71                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-72                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-52                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-53                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-19           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-74          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-75                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-76                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-55                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-56                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-20           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-78          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-79                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-80                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-58                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-59                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-21           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-82          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-83                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-84                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-61                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-62                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-22           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-86          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-87                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-88                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-64                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-65                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-23           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-90          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-91                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-92                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-67                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-68                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-24           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-94          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-95                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-96                  [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-70                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-71                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    └─LayerNorm: 2-4                              [1, 512, 1024]            [1, 512, 1024]            2,048                       0.00%                   --                        2,048
│    └─Conv2d: 2-5                                 [1, 1024, 512, 1]         [1, 12, 512, 1]           12,300                      0.00%                   [1, 1]                    6,297,600
├─VectorQuantizer: 1-2                             [1, 12, 1, 512]           [1, 12, 1, 512]           --                             --                   --                        --
│    └─Embedding: 2-6                              [512]                     [512, 12]                 49,152                      0.01%                   --                        25,165,824
├─TiTokDecoder: 1-3                                [1, 12, 1, 512]           [1, 1024, 16, 16]         789,504                     0.13%                   --                        --
│    └─Linear: 2-7                                 [1, 512, 12]              [1, 512, 1024]            13,312                      0.00%                   --                        13,312
│    └─LayerNorm: 2-8                              [1, 769, 1024]            [1, 769, 1024]            2,048                       0.00%                   --                        2,048
│    └─ModuleList: 2-9                             --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-25           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-97                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-98          [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-99                   [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-100                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-73                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-74                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-75                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-26           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-101                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-102         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-103                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-104                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-76                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-77                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-78                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-27           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-105                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-106         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-107                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-108                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-79                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-80                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-81                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-28           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-109                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-110         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-111                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-112                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-82                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-83                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-84                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-29           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-113                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-114         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-115                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-116                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-85                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-86                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-87                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-30           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-117                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-118         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-119                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-120                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-88                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-89                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-90                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-31           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-121                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-122         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-123                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-124                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-91                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-92                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-93                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-32           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-125                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-126         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-127                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-128                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-94                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-95                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-96                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-33           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-129                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-130         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-131                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-132                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-97                 [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-98                   [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-99                 [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-34           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-133                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-134         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-135                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-136                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-100                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-101                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-102                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-35           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-137                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-138         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-139                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-140                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-103                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-104                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-105                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-36           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-141                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-142         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-143                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-144                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-106                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-107                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-108                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-37           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-145                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-146         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-147                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-148                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-109                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-110                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-111                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-38           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-149                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-150         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-151                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-152                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-112                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-113                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-114                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-39           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-153                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-154         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-155                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-156                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-115                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-116                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-117                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-40           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-157                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-158         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-159                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-160                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-118                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-119                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-120                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-41           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-161                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-162         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-163                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-164                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-121                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-122                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-123                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-42           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-165                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-166         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-167                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-168                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-124                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-125                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-126                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-43           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-169                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-170         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-171                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-172                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-127                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-128                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-129                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-44           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-173                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-174         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-175                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-176                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-130                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-131                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-132                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-45           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-177                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-178         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-179                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-180                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-133                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-134                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-135                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-46           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-181                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-182         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-183                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-184                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-136                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-137                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-138                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-47           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-185                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-186         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-187                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-188                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-139                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-140                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-141                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    │    └─ResidualAttentionBlock: 3-48           [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    └─LayerNorm: 4-189                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─MultiheadAttention: 4-190         [769, 1, 1024]            [769, 1, 1024]            4,198,400                   0.69%                   --                        --
│    │    │    └─LayerNorm: 4-191                  [769, 1, 1024]            [769, 1, 1024]            2,048                       0.00%                   --                        1,574,912
│    │    │    └─Sequential: 4-192                 [769, 1, 1024]            [769, 1, 1024]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-142                [769, 1, 1024]            [769, 1, 4096]            4,198,400                   0.69%                   --                        3,228,569,600
│    │    │    │    └─GELU: 5-143                  [769, 1, 4096]            [769, 1, 4096]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-144                [769, 1, 4096]            [769, 1, 1024]            4,195,328                   0.69%                   --                        3,226,207,232
│    └─LayerNorm: 2-10                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
│    └─Sequential: 2-11                            [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-49                           [1, 1024, 16, 16]         [1, 2048, 16, 16]         2,099,200                   0.34%                   [1, 1]                    537,395,200
│    │    └─Tanh: 3-50                             [1, 2048, 16, 16]         [1, 2048, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-51                           [1, 2048, 16, 16]         [1, 1024, 16, 16]         2,098,176                   0.34%                   [1, 1]                    537,133,056
│    └─Identity: 2-12                              [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
========================================================================================================================================================================================================
Total params: 611,788,812
Trainable params: 611,788,812
Non-trainable params: 0
Total mult-adds (G): 311.29
========================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 2148.25
Params size (MB): 1632.65
Estimated Total Size (MB): 3781.69
========================================================================================================================================================================================================
[01/16 01:51:52 TiTok]: Creating optimizers.
[01/16 01:51:52 TiTok]: Creating lr_schedulers.
[01/16 01:51:52 TiTok]: Creating dataloaders.
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
[01/16 01:51:52 TiTok]: Creating evaluator.
[01/16 01:51:52 TiTok]: Preparing model, optimizer and dataloaders
[01/16 01:51:52 TiTok]: ***** Running training *****
[01/16 01:51:52 TiTok]:   Num training steps = 250000
[01/16 01:51:52 TiTok]:   Gradient Accumulation steps = 1
[01/16 01:51:52 TiTok]:   Instantaneous batch size per gpu = 128
[01/16 01:51:52 TiTok]:   Total train batch size (w. parallel, distributed & accumulation) = 128
[01/16 01:51:52 TiTok]: All globbed checkpoints are: []
[01/16 01:51:52 TiTok]: Training from scratch.
Epoch 0/24 started.
