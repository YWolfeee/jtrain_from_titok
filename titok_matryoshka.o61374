Sun Jan  5 15:56:43 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.28.03              Driver Version: 560.28.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A40                     Off |   00000000:2D:00.0 Off |                    0 |
|  0%   28C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A40                     Off |   00000000:3A:00.0 Off |                    0 |
|  0%   26C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A40                     Off |   00000000:3B:00.0 Off |                    0 |
|  0%   27C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A40                     Off |   00000000:3C:00.0 Off |                    0 |
|  0%   28C    P8             22W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   4  NVIDIA A40                     Off |   00000000:AD:00.0 Off |                    0 |
|  0%   28C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   5  NVIDIA A40                     Off |   00000000:AE:00.0 Off |                    0 |
|  0%   28C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   6  NVIDIA A40                     Off |   00000000:BD:00.0 Off |                    0 |
|  0%   27C    P8             21W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   7  NVIDIA A40                     Off |   00000000:BE:00.0 Off |                    0 |
|  0%   28C    P8             27W /  300W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
attention mode is flashattention mode is flashattention mode is flash
attention mode is flash
attention mode is flashattention mode is flashattention mode is flash




attention mode is flash
[01/05 15:57:23 TiTok]: Saving config to titok_s128_matryoshka_annealing_stage1_run1/config.yaml
[01/05 15:57:23 TiTok]: Config:
experiment:
  project: titok_s128_matryoshka_annealing_stage1
  name: titok_s128_matryoshka_annealing_stage1_run1
  output_dir: titok_s128_matryoshka_annealing_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  init_weight: ''
  logging_dir: titok_s128_matryoshka_annealing_stage1_run1/logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 128
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
  reconstruction_regularization:
    name: matryoshka
    mask_ratio_method: uniform
    max_mask_rate: 0.999
    annealing:
      time_start: 0.25
      time_end: 0.75
losses:
  quantizer_weight: 1.0
dataset:
  params:
    train_shards_path_or_url: /mnt/rdata8/imagenet_wds/imagenet-train-{000000..000252}.tar
    eval_shards_path_or_url: /mnt/rdata8/imagenet_wds/imagenet-val-{000000..000009}.tar
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 32
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 1000000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_s128_matryoshka_annealing.yaml

[01/05 15:57:33 TiTok]: Creating model and loss module.
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         98,304                      0.06%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 128]           296,448                     0.17%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-2      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-4              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-2               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-2       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-6      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-8              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-5               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-3       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-10     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-12             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-8               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-4       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-14     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-16             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-11              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-5       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-18     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-20             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-14              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-6       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-22     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-24             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-17              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-7       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-26     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-28             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-20              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-8       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-30     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-32             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-23              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-9       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-34     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-36             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-26              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-10      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-38     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-40             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-29              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-11      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-42     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-44             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-32              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-12      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-46     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-48             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-35              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    └─LayerNorm: 2-4                         [1, 128, 768]             [1, 128, 768]             1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 128, 1]          [1, 12, 128, 1]           9,228                       0.01%                   [1, 1]                    1,181,184
├─VectorQuantizer: 1-2                        [1, 12, 1, 128]           [1, 12, 1, 128]           --                             --                   --                        --
│    └─Embedding: 2-6                         [128]                     [128, 12]                 49,152                      0.03%                   --                        6,291,456
├─TiTokDecoder: 1-3                           [1, 12, 1, 128]           [1, 1024, 16, 16]         297,216                     0.17%                   --                        --
│    └─Linear: 2-7                            [1, 128, 12]              [1, 128, 768]             9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-50     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-52             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-38              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-14      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-54     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-56             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-41              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-15      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-58     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-60             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-44              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-16      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-62     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-64             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-47              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-17      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-66     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-68             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-50              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-18      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-70     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-72             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-53              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-19      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-74     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-76             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-56              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-20      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-78     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-80             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-59              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-21      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-82     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-84             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-62              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-22      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-86     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-88             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-65              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-23      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-90     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-92             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-68              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-24      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-94     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-96             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-71              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,221,068
Trainable params: 174,221,068
Non-trainable params: 0
Total mult-adds (G): 44.53
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 412.11
Params size (MB): 467.33
Estimated Total Size (MB): 880.23
===================================================================================================================================================================================================
[01/05 15:58:11 TiTok]: ===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         98,304                      0.06%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 128]           296,448                     0.17%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-2      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-4              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-2               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-2       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-6      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-8              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-5               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-3       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-10     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-12             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-8               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-4       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-14     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-16             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-11              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-5       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-18     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-20             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-14              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-6       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-22     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-24             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-17              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-7       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-26     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-28             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-20              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-8       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-30     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-32             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-23              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-9       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-34     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-36             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-26              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-10      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-38     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-40             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-29              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-11      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-42     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-44             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-32              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-12      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-46     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-48             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-35              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    └─LayerNorm: 2-4                         [1, 128, 768]             [1, 128, 768]             1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 128, 1]          [1, 12, 128, 1]           9,228                       0.01%                   [1, 1]                    1,181,184
├─VectorQuantizer: 1-2                        [1, 12, 1, 128]           [1, 12, 1, 128]           --                             --                   --                        --
│    └─Embedding: 2-6                         [128]                     [128, 12]                 49,152                      0.03%                   --                        6,291,456
├─TiTokDecoder: 1-3                           [1, 12, 1, 128]           [1, 1024, 16, 16]         297,216                     0.17%                   --                        --
│    └─Linear: 2-7                            [1, 128, 12]              [1, 128, 768]             9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-50     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-52             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-38              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-14      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-54     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-56             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-41              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-15      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-58     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-60             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-44              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-16      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-62     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-64             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-47              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-17      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-66     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-68             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-50              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-18      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-70     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-72             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-53              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-19      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-74     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-76             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-56              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-20      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-78     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-80             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-59              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-21      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-82     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-84             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-62              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-22      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-86     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-88             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-65              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-23      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-90     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-92             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-68              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    │    └─ResidualAttentionBlock: 3-24      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─MultiheadAttention: 4-94     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
│    │    │    └─Sequential: 4-96             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
│    │    │    │    └─GELU: 5-71              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,221,068
Trainable params: 174,221,068
Non-trainable params: 0
Total mult-adds (G): 44.53
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 412.11
Params size (MB): 467.33
Estimated Total Size (MB): 880.23
===================================================================================================================================================================================================
[01/05 15:58:11 TiTok]: Creating optimizers.
[01/05 15:58:11 TiTok]: Creating lr_schedulers.
[01/05 15:58:11 TiTok]: Creating dataloaders.
self.train_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    RandomCrop(size=(256, 256), padding=None)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
self.eval_transform: Compose(
    Resize(size=256, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
[01/05 15:58:11 TiTok]: Creating evaluator.
[01/05 15:58:16 TiTok]: Preparing model, optimizer and dataloaders
[01/05 15:58:16 TiTok]: ***** Running training *****
[01/05 15:58:16 TiTok]:   Num training steps = 1000000
[01/05 15:58:16 TiTok]:   Gradient Accumulation steps = 1
[01/05 15:58:16 TiTok]:   Instantaneous batch size per gpu = 32
[01/05 15:58:16 TiTok]:   Total train batch size (w. parallel, distributed & accumulation) = 256
[01/05 15:58:16 TiTok]: All globbed checkpoints are: []
[01/05 15:58:16 TiTok]: Training from scratch.
Epoch 0/199 started.
[01/05 15:59:11 TiTok]: Data (t): 0.0013, 51.29/s/gpu Batch (t): 0.6239 LR: 0.000001 Step: 50 Total Loss: 6.9832 Recon Loss: 6.9683 
[01/05 15:59:43 TiTok]: Data (t): 0.0015, 51.12/s/gpu Batch (t): 0.6260 LR: 0.000001 Step: 100 Total Loss: 6.9351 Recon Loss: 6.9345 
[01/05 16:00:14 TiTok]: Data (t): 0.0013, 51.36/s/gpu Batch (t): 0.6230 LR: 0.000002 Step: 150 Total Loss: 6.9004 Recon Loss: 6.9001 
[01/05 16:00:45 TiTok]: Data (t): 0.0013, 51.30/s/gpu Batch (t): 0.6238 LR: 0.000002 Step: 200 Total Loss: 6.8817 Recon Loss: 6.8816 
[01/05 16:01:17 TiTok]: Data (t): 0.0012, 51.19/s/gpu Batch (t): 0.6252 LR: 0.000003 Step: 250 Total Loss: 6.8801 Recon Loss: 6.8800 
[01/05 16:01:48 TiTok]: Data (t): 0.0013, 51.00/s/gpu Batch (t): 0.6275 LR: 0.000003 Step: 300 Total Loss: 6.8815 Recon Loss: 6.8815 
[01/05 16:02:19 TiTok]: Data (t): 0.0013, 51.23/s/gpu Batch (t): 0.6247 LR: 0.000004 Step: 350 Total Loss: 6.8805 Recon Loss: 6.8804 
[01/05 16:02:51 TiTok]: Data (t): 0.0012, 51.20/s/gpu Batch (t): 0.6250 LR: 0.000004 Step: 400 Total Loss: 6.8677 Recon Loss: 6.8677 
[01/05 16:03:22 TiTok]: Data (t): 0.0013, 51.04/s/gpu Batch (t): 0.6270 LR: 0.000005 Step: 450 Total Loss: 6.8683 Recon Loss: 6.8682 
[01/05 16:03:53 TiTok]: Data (t): 0.0013, 50.91/s/gpu Batch (t): 0.6286 LR: 0.000005 Step: 500 Total Loss: 6.8747 Recon Loss: 6.8746 
[01/05 16:04:25 TiTok]: Data (t): 0.0013, 51.08/s/gpu Batch (t): 0.6265 LR: 0.000006 Step: 550 Total Loss: 6.8751 Recon Loss: 6.8751 
[01/05 16:04:56 TiTok]: Data (t): 0.0012, 50.09/s/gpu Batch (t): 0.6388 LR: 0.000006 Step: 600 Total Loss: 6.8692 Recon Loss: 6.8692 
[01/05 16:05:27 TiTok]: Data (t): 0.0013, 51.42/s/gpu Batch (t): 0.6224 LR: 0.000007 Step: 650 Total Loss: 6.8671 Recon Loss: 6.8669 
[01/05 16:05:59 TiTok]: Data (t): 0.0012, 51.25/s/gpu Batch (t): 0.6244 LR: 0.000007 Step: 700 Total Loss: 6.8529 Recon Loss: 6.8521 
[01/05 16:06:30 TiTok]: Data (t): 0.0013, 51.03/s/gpu Batch (t): 0.6270 LR: 0.000008 Step: 750 Total Loss: 6.8440 Recon Loss: 6.8407 
[01/05 16:07:02 TiTok]: Data (t): 0.0013, 50.95/s/gpu Batch (t): 0.6281 LR: 0.000008 Step: 800 Total Loss: 6.8195 Recon Loss: 6.8177 
[01/05 16:07:33 TiTok]: Data (t): 0.0012, 51.26/s/gpu Batch (t): 0.6243 LR: 0.000009 Step: 850 Total Loss: 6.8037 Recon Loss: 6.8019 
[01/05 16:08:04 TiTok]: Data (t): 0.0012, 51.07/s/gpu Batch (t): 0.6266 LR: 0.000009 Step: 900 Total Loss: 6.7977 Recon Loss: 6.7945 
[01/05 16:08:36 TiTok]: Data (t): 0.0012, 50.66/s/gpu Batch (t): 0.6317 LR: 0.000010 Step: 950 Total Loss: 6.7814 Recon Loss: 6.7790 
[01/05 16:09:07 TiTok]: Data (t): 0.0013, 43.40/s/gpu Batch (t): 0.7373 LR: 0.000010 Step: 1000 Total Loss: 6.7536 Recon Loss: 6.7509 
[01/05 16:09:38 TiTok]: Data (t): 0.0013, 51.20/s/gpu Batch (t): 0.6250 LR: 0.000010 Step: 1050 Total Loss: 6.7740 Recon Loss: 6.7713 
[01/05 16:10:10 TiTok]: Data (t): 0.0012, 50.81/s/gpu Batch (t): 0.6298 LR: 0.000011 Step: 1100 Total Loss: 6.7467 Recon Loss: 6.7442 
[01/05 16:10:41 TiTok]: Data (t): 0.0015, 50.63/s/gpu Batch (t): 0.6320 LR: 0.000012 Step: 1150 Total Loss: 6.7670 Recon Loss: 6.7649 
[01/05 16:11:13 TiTok]: Data (t): 0.0012, 51.26/s/gpu Batch (t): 0.6242 LR: 0.000012 Step: 1200 Total Loss: 6.7287 Recon Loss: 6.7265 
[01/05 16:11:44 TiTok]: Data (t): 0.0012, 50.61/s/gpu Batch (t): 0.6323 LR: 0.000013 Step: 1250 Total Loss: 6.7337 Recon Loss: 6.7312 
[01/05 16:12:15 TiTok]: Data (t): 0.0012, 51.27/s/gpu Batch (t): 0.6242 LR: 0.000013 Step: 1300 Total Loss: 6.7167 Recon Loss: 6.7141 
[01/05 16:12:47 TiTok]: Data (t): 0.0012, 51.16/s/gpu Batch (t): 0.6255 LR: 0.000014 Step: 1350 Total Loss: 6.7045 Recon Loss: 6.7019 
[01/05 16:13:18 TiTok]: Data (t): 0.0013, 50.81/s/gpu Batch (t): 0.6298 LR: 0.000014 Step: 1400 Total Loss: 6.7021 Recon Loss: 6.6996 
[01/05 16:13:49 TiTok]: Data (t): 0.0012, 51.11/s/gpu Batch (t): 0.6261 LR: 0.000015 Step: 1450 Total Loss: 6.7036 Recon Loss: 6.7011 
[01/05 16:14:21 TiTok]: Data (t): 0.0012, 50.95/s/gpu Batch (t): 0.6280 LR: 0.000015 Step: 1500 Total Loss: 6.6869 Recon Loss: 6.6846 
[01/05 16:14:52 TiTok]: Data (t): 0.0012, 51.33/s/gpu Batch (t): 0.6234 LR: 0.000016 Step: 1550 Total Loss: 6.6616 Recon Loss: 6.6592 
[01/05 16:15:23 TiTok]: Data (t): 0.0012, 51.14/s/gpu Batch (t): 0.6257 LR: 0.000016 Step: 1600 Total Loss: 6.6896 Recon Loss: 6.6874 
[01/05 16:15:55 TiTok]: Data (t): 0.0013, 51.26/s/gpu Batch (t): 0.6243 LR: 0.000017 Step: 1650 Total Loss: 6.6719 Recon Loss: 6.6698 
[01/05 16:16:26 TiTok]: Data (t): 0.0012, 51.03/s/gpu Batch (t): 0.6271 LR: 0.000017 Step: 1700 Total Loss: 6.6863 Recon Loss: 6.6841 
[01/05 16:16:57 TiTok]: Data (t): 0.0013, 51.28/s/gpu Batch (t): 0.6240 LR: 0.000017 Step: 1750 Total Loss: 6.6603 Recon Loss: 6.6579 
[01/05 16:17:29 TiTok]: Data (t): 0.0012, 50.37/s/gpu Batch (t): 0.6353 LR: 0.000018 Step: 1800 Total Loss: 6.6752 Recon Loss: 6.6730 
[01/05 16:18:00 TiTok]: Data (t): 0.0017, 51.13/s/gpu Batch (t): 0.6259 LR: 0.000018 Step: 1850 Total Loss: 6.6527 Recon Loss: 6.6505 
[01/05 16:18:31 TiTok]: Data (t): 0.0012, 51.41/s/gpu Batch (t): 0.6225 LR: 0.000019 Step: 1900 Total Loss: 6.6667 Recon Loss: 6.6644 
[01/05 16:19:03 TiTok]: Data (t): 0.0015, 50.36/s/gpu Batch (t): 0.6354 LR: 0.000020 Step: 1950 Total Loss: 6.6626 Recon Loss: 6.6601 
[01/05 16:19:34 TiTok]: Data (t): 0.0012, 43.65/s/gpu Batch (t): 0.7331 LR: 0.000020 Step: 2000 Total Loss: 6.6271 Recon Loss: 6.6249 
[01/05 16:20:05 TiTok]: Data (t): 0.0012, 50.69/s/gpu Batch (t): 0.6313 LR: 0.000021 Step: 2050 Total Loss: 6.6391 Recon Loss: 6.6369 
[01/05 16:20:37 TiTok]: Data (t): 0.0012, 51.27/s/gpu Batch (t): 0.6241 LR: 0.000021 Step: 2100 Total Loss: 6.6513 Recon Loss: 6.6491 
[01/05 16:21:08 TiTok]: Data (t): 0.0012, 51.16/s/gpu Batch (t): 0.6255 LR: 0.000022 Step: 2150 Total Loss: 6.6338 Recon Loss: 6.6314 
[01/05 16:21:39 TiTok]: Data (t): 0.0012, 51.24/s/gpu Batch (t): 0.6246 LR: 0.000022 Step: 2200 Total Loss: 6.6190 Recon Loss: 6.6167 
[01/05 16:22:11 TiTok]: Data (t): 0.0012, 51.30/s/gpu Batch (t): 0.6238 LR: 0.000023 Step: 2250 Total Loss: 6.6156 Recon Loss: 6.6133 
[01/05 16:22:42 TiTok]: Data (t): 0.0012, 51.23/s/gpu Batch (t): 0.6247 LR: 0.000023 Step: 2300 Total Loss: 6.6274 Recon Loss: 6.6252 
[01/05 16:23:13 TiTok]: Data (t): 0.0012, 51.14/s/gpu Batch (t): 0.6257 LR: 0.000023 Step: 2350 Total Loss: 6.6240 Recon Loss: 6.6217 
[01/05 16:23:45 TiTok]: Data (t): 0.0012, 50.77/s/gpu Batch (t): 0.6303 LR: 0.000024 Step: 2400 Total Loss: 6.6188 Recon Loss: 6.6165 
[01/05 16:24:16 TiTok]: Data (t): 0.0013, 50.39/s/gpu Batch (t): 0.6350 LR: 0.000024 Step: 2450 Total Loss: 6.6230 Recon Loss: 6.6207 
[01/05 16:24:47 TiTok]: Data (t): 0.0016, 51.40/s/gpu Batch (t): 0.6225 LR: 0.000025 Step: 2500 Total Loss: 6.5999 Recon Loss: 6.5975 
[01/05 16:25:19 TiTok]: Data (t): 0.0012, 51.31/s/gpu Batch (t): 0.6236 LR: 0.000026 Step: 2550 Total Loss: 6.5888 Recon Loss: 6.5865 
[01/05 16:25:50 TiTok]: Data (t): 0.0012, 51.22/s/gpu Batch (t): 0.6248 LR: 0.000026 Step: 2600 Total Loss: 6.5783 Recon Loss: 6.5760 
[01/05 16:26:21 TiTok]: Data (t): 0.0013, 50.85/s/gpu Batch (t): 0.6292 LR: 0.000027 Step: 2650 Total Loss: 6.5587 Recon Loss: 6.5563 
[01/05 16:26:53 TiTok]: Data (t): 0.0012, 51.26/s/gpu Batch (t): 0.6243 LR: 0.000027 Step: 2700 Total Loss: 6.5628 Recon Loss: 6.5604 
[01/05 16:27:24 TiTok]: Data (t): 0.0013, 49.80/s/gpu Batch (t): 0.6425 LR: 0.000028 Step: 2750 Total Loss: 6.5592 Recon Loss: 6.5567 
[01/05 16:27:55 TiTok]: Data (t): 0.0012, 51.28/s/gpu Batch (t): 0.6241 LR: 0.000028 Step: 2800 Total Loss: 6.5571 Recon Loss: 6.5548 
[01/05 16:28:27 TiTok]: Data (t): 0.0012, 51.05/s/gpu Batch (t): 0.6268 LR: 0.000028 Step: 2850 Total Loss: 6.5431 Recon Loss: 6.5406 
[01/05 16:28:58 TiTok]: Data (t): 0.0016, 51.04/s/gpu Batch (t): 0.6270 LR: 0.000029 Step: 2900 Total Loss: 6.5387 Recon Loss: 6.5362 
[01/05 16:29:29 TiTok]: Data (t): 0.0014, 51.27/s/gpu Batch (t): 0.6241 LR: 0.000029 Step: 2950 Total Loss: 6.5434 Recon Loss: 6.5410 
[01/05 16:30:01 TiTok]: Data (t): 0.0011, 44.70/s/gpu Batch (t): 0.7158 LR: 0.000030 Step: 3000 Total Loss: 6.5071 Recon Loss: 6.5045 
[01/05 16:30:30 TiTok]: Data (t): 0.0012, 53.83/s/gpu Batch (t): 0.5944 LR: 0.000030 Step: 3050 Total Loss: 6.5172 Recon Loss: 6.5146 
[01/05 16:31:00 TiTok]: Data (t): 0.0011, 51.47/s/gpu Batch (t): 0.6217 LR: 0.000031 Step: 3100 Total Loss: 6.5104 Recon Loss: 6.5078 
[01/05 16:31:30 TiTok]: Data (t): 0.0012, 53.24/s/gpu Batch (t): 0.6011 LR: 0.000031 Step: 3150 Total Loss: 6.5113 Recon Loss: 6.5087 
[01/05 16:32:00 TiTok]: Data (t): 0.0011, 54.56/s/gpu Batch (t): 0.5865 LR: 0.000032 Step: 3200 Total Loss: 6.4822 Recon Loss: 6.4795 
[01/05 16:32:29 TiTok]: Data (t): 0.0011, 54.60/s/gpu Batch (t): 0.5861 LR: 0.000033 Step: 3250 Total Loss: 6.4839 Recon Loss: 6.4812 
[01/05 16:32:59 TiTok]: Data (t): 0.0011, 54.56/s/gpu Batch (t): 0.5865 LR: 0.000033 Step: 3300 Total Loss: 6.4820 Recon Loss: 6.4792 
[01/05 16:33:28 TiTok]: Data (t): 0.0011, 54.66/s/gpu Batch (t): 0.5855 LR: 0.000034 Step: 3350 Total Loss: 6.4803 Recon Loss: 6.4777 
[01/05 16:33:58 TiTok]: Data (t): 0.0011, 53.89/s/gpu Batch (t): 0.5938 LR: 0.000034 Step: 3400 Total Loss: 6.4848 Recon Loss: 6.4821 
[01/05 16:34:28 TiTok]: Data (t): 0.0011, 52.70/s/gpu Batch (t): 0.6072 LR: 0.000034 Step: 3450 Total Loss: 6.4613 Recon Loss: 6.4584 
[01/05 16:34:58 TiTok]: Data (t): 0.0013, 54.53/s/gpu Batch (t): 0.5868 LR: 0.000035 Step: 3500 Total Loss: 6.4385 Recon Loss: 6.4358 
[01/05 16:35:27 TiTok]: Data (t): 0.0011, 51.54/s/gpu Batch (t): 0.6208 LR: 0.000036 Step: 3550 Total Loss: 6.4260 Recon Loss: 6.4231 
[01/05 16:35:57 TiTok]: Data (t): 0.0011, 51.70/s/gpu Batch (t): 0.6190 LR: 0.000036 Step: 3600 Total Loss: 6.4041 Recon Loss: 6.4012 
[01/05 16:36:27 TiTok]: Data (t): 0.0014, 54.51/s/gpu Batch (t): 0.5871 LR: 0.000036 Step: 3650 Total Loss: 6.4279 Recon Loss: 6.4250 
[01/05 16:36:56 TiTok]: Data (t): 0.0011, 54.08/s/gpu Batch (t): 0.5917 LR: 0.000037 Step: 3700 Total Loss: 6.4446 Recon Loss: 6.4416 
[01/05 16:37:26 TiTok]: Data (t): 0.0012, 54.22/s/gpu Batch (t): 0.5902 LR: 0.000038 Step: 3750 Total Loss: 6.4297 Recon Loss: 6.4267 
[01/05 16:37:56 TiTok]: Data (t): 0.0011, 54.25/s/gpu Batch (t): 0.5898 LR: 0.000038 Step: 3800 Total Loss: 6.3914 Recon Loss: 6.3883 
[01/05 16:38:26 TiTok]: Data (t): 0.0011, 54.03/s/gpu Batch (t): 0.5923 LR: 0.000039 Step: 3850 Total Loss: 6.3989 Recon Loss: 6.3958 
[01/05 16:38:56 TiTok]: Data (t): 0.0011, 54.60/s/gpu Batch (t): 0.5861 LR: 0.000039 Step: 3900 Total Loss: 6.3883 Recon Loss: 6.3851 
[01/05 16:39:26 TiTok]: Data (t): 0.0011, 54.51/s/gpu Batch (t): 0.5871 LR: 0.000040 Step: 3950 Total Loss: 6.4395 Recon Loss: 6.4364 
[01/05 16:39:56 TiTok]: Data (t): 0.0012, 44.44/s/gpu Batch (t): 0.7201 LR: 0.000040 Step: 4000 Total Loss: 6.3664 Recon Loss: 6.3631 
[01/05 16:40:25 TiTok]: Data (t): 0.0011, 54.42/s/gpu Batch (t): 0.5880 LR: 0.000041 Step: 4050 Total Loss: 6.3718 Recon Loss: 6.3685 
[01/05 16:40:55 TiTok]: Data (t): 0.0011, 54.67/s/gpu Batch (t): 0.5853 LR: 0.000041 Step: 4100 Total Loss: 6.3818 Recon Loss: 6.3786 
[01/05 16:41:25 TiTok]: Data (t): 0.0013, 51.25/s/gpu Batch (t): 0.6244 LR: 0.000041 Step: 4150 Total Loss: 6.3238 Recon Loss: 6.3205 
[01/05 16:41:55 TiTok]: Data (t): 0.0013, 53.20/s/gpu Batch (t): 0.6015 LR: 0.000042 Step: 4200 Total Loss: 6.3471 Recon Loss: 6.3437 
[01/05 16:42:25 TiTok]: Data (t): 0.0011, 54.59/s/gpu Batch (t): 0.5861 LR: 0.000043 Step: 4250 Total Loss: 6.3203 Recon Loss: 6.3170 
[01/05 16:42:55 TiTok]: Data (t): 0.0012, 54.48/s/gpu Batch (t): 0.5874 LR: 0.000043 Step: 4300 Total Loss: 6.3403 Recon Loss: 6.3369 
[01/05 16:43:25 TiTok]: Data (t): 0.0012, 54.52/s/gpu Batch (t): 0.5869 LR: 0.000044 Step: 4350 Total Loss: 6.3500 Recon Loss: 6.3466 
[01/05 16:43:54 TiTok]: Data (t): 0.0011, 53.10/s/gpu Batch (t): 0.6026 LR: 0.000044 Step: 4400 Total Loss: 6.3189 Recon Loss: 6.3155 
[01/05 16:44:24 TiTok]: Data (t): 0.0017, 54.56/s/gpu Batch (t): 0.5866 LR: 0.000045 Step: 4450 Total Loss: 6.3288 Recon Loss: 6.3253 
[01/05 16:44:54 TiTok]: Data (t): 0.0011, 54.40/s/gpu Batch (t): 0.5882 LR: 0.000045 Step: 4500 Total Loss: 6.2855 Recon Loss: 6.2819 
[01/05 16:45:24 TiTok]: Data (t): 0.0011, 54.56/s/gpu Batch (t): 0.5865 LR: 0.000046 Step: 4550 Total Loss: 6.3150 Recon Loss: 6.3114 
[01/05 16:45:53 TiTok]: Data (t): 0.0012, 52.56/s/gpu Batch (t): 0.6088 LR: 0.000046 Step: 4600 Total Loss: 6.2765 Recon Loss: 6.2729 
[01/05 16:46:23 TiTok]: Data (t): 0.0011, 51.49/s/gpu Batch (t): 0.6214 LR: 0.000047 Step: 4650 Total Loss: 6.2836 Recon Loss: 6.2800 
[01/05 16:46:53 TiTok]: Data (t): 0.0011, 54.56/s/gpu Batch (t): 0.5865 LR: 0.000047 Step: 4700 Total Loss: 6.2634 Recon Loss: 6.2598 
[01/05 16:47:23 TiTok]: Data (t): 0.0011, 54.60/s/gpu Batch (t): 0.5861 LR: 0.000048 Step: 4750 Total Loss: 6.2674 Recon Loss: 6.2637 
[01/05 16:47:52 TiTok]: Data (t): 0.0011, 54.64/s/gpu Batch (t): 0.5857 LR: 0.000048 Step: 4800 Total Loss: 6.2699 Recon Loss: 6.2662 
[01/05 16:48:22 TiTok]: Data (t): 0.0011, 54.45/s/gpu Batch (t): 0.5877 LR: 0.000048 Step: 4850 Total Loss: 6.2166 Recon Loss: 6.2127 
[01/05 16:48:52 TiTok]: Data (t): 0.0011, 54.13/s/gpu Batch (t): 0.5912 LR: 0.000049 Step: 4900 Total Loss: 6.2577 Recon Loss: 6.2539 
[01/05 16:49:22 TiTok]: Data (t): 0.0011, 54.50/s/gpu Batch (t): 0.5872 LR: 0.000050 Step: 4950 Total Loss: 6.2593 Recon Loss: 6.2555 
[01/05 16:49:52 TiTok]: Data (t): 0.0012, 45.58/s/gpu Batch (t): 0.7021 LR: 0.000050 Step: 5000 Total Loss: 6.2201 Recon Loss: 6.2163 
[01/05 16:49:53 TiTok]: Reconstructing images...
[1;34mwandb[0m: 🚀 View run [33mmisunderstood-donkey-1[0m at: [34mhttps://wandb.ai/guided-diffusion/titok_s128_matryoshka_annealing_stage1_run1/runs/d94yz0km[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250105_155722-d94yz0km/logs[0m
